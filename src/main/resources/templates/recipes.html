<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"> 
<head>
    <meta charset="UTF-8">
    <title>Elenco ricette</title>
    <link rel="stylesheet" href="/css/recipes.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="magic-background"></div>

	<header>
	    <div class="header-content-wrapper" style="display: flex; justify-content: space-between; align-items: center;">
	    
	        <div class="left-actions">
	            
	            <div sec:authorize="hasAuthority('ADMIN')" class="admin-link-header-left">
	                <a th:href="@{/admin}" class="action-manage" style="color: white; text-decoration: none; font-weight: bold;">
	                    <i class="fa-solid fa-crown"></i> Gestione Admin
	                </a>
	            </div>
	            
	            <div sec:authorize="isAuthenticated() && !hasAuthority('ADMIN')">
	                <a th:href="@{/myRecipes}" class="action-manage" style="color: #B8860B; text-decoration: none; font-weight: bold; font-family: 'Cinzel Decorative', serif;">
	                    <i class="fa-solid fa-scroll"></i> Le mie ricette
	                </a>
	            </div>

	        </div>
	        
	        <div class="user-actions-right">
	            
	            <div sec:authorize="isAuthenticated()">
	                <span class="chef-name">
	                    âœ¨ Chef <span sec:authentication="name">NomeUtente</span>
	                </span>
	                <a th:href="@{/logout}" class="btn-auth btn-logout">Logout</a>
	            </div>

	            <div sec:authorize="!isAuthenticated()">
	                <span class="welcome-text">Benvenuto!</span>
	                <a th:href="@{/login}" class="btn-auth btn-login">Accedi</a>
	                <a th:href="@{/register}" class="btn-auth btn-register">Registrati</a>
	            </div>
	            
	        </div>
	    </div>
	</header>

    <div class="logo-container">
        <a th:href="@{/}">
            <img src="/images/logo2.png" class="main-logo" alt="Logo" onerror="this.style.display='none'"/>
        </a>  
    </div>

    <h1 class="main-title">ELENCO RICETTE</h1>
    
    <div class="action-bar-wrapper">
        
        <div class="search-container">
            <form th:action="@{/searchRecipes}" method="get" class="elegant-search-form">
                
                <div class="search-field">
                    <input type="text" name="title" placeholder="ðŸ” Cerca per Titolo..." />
                </div>

                <div class="search-field" style="margin-left: 20px;">
                   <input type="text" name="ingredient" placeholder="ðŸŒ¾ Cerca per Ingrediente..." />
                </div>
                
                <button type="submit" class="search-button">CERCA</button>
            </form>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(recipes)}">
        <p style="text-align: center; color: white; font-size: 1.2rem;">Nessuna ricetta trovata.</p>
    </div>

    <ul class="recipe-cards-list">
        <li th:each="recipe : ${recipes}" class="recipe-card">
            
            <div class="card-image">
                <img th:src="${recipe.imageUrl} ? ${recipe.imageUrl} : '/images/placeholder-piatto.jpg'" 
                     th:alt="'Immagine di ' + ${recipe.title}"
                     style="width: 100%; height: 200px; object-fit: cover;"/>
            </div>
            
            <div class="card-content">
                <a th:href="@{'/recipe/' + ${recipe.id}}" th:text="${recipe.title}" class="recipe-title">Titolo Ricetta</a>
                
                <p class="recipe-description" th:text="${recipe.description}">Descrizione...</p>

                <div class="card-metadata-inline">
                    <p>
                        <i class="fa-regular fa-clock icon-gold"></i> 
                        <span th:text="${recipe.preparationTime}">0</span> min
                    </p>
                    
                    <p>
                        <i class="fa-solid fa-fire-burner icon-gold"></i> 
                        <span th:text="${recipe.cookingTime}">0</span> min
                    </p>
                    
                    <p>
                        <i class="fa-solid fa-star icon-gold"></i> 
                        <span th:text="${recipe.difficulty}">Facile</span>
                    </p>
                </div>
            </div>
        </li>
    </ul>

</body>
</html>