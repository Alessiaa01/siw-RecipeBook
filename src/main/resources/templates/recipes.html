<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"> 
<head>
    <meta charset="UTF-8">
    <title>Elenco Ricette</title>
    <link rel="stylesheet" href="/css/recipes.css" />
</head>

<body>
    <header>
        <div th:if="${userDetails}">
            <span class="chef-name">‚ú® Chef <span th:text="${userDetails.username}"></span></span>
            <a href="/logout">Logout</a>
        </div>
        <div th:unless="${userDetails}">
            <a href="/login">Login</a>
        </div>
    </header>

    <div>
        <a href="/"><img src="/images/logo-siw.png" width="50%" alt="Logo Biblioteca Incantata"/></a>  
    </div>

    <h1 class="main-title"><ELENCO RICETTE></h1>

    <div class="search-container">
        <form th:action="@{/searchRecipes}" method="get" class="elegant-search-form">
            
            <div class="search-field">
                <label>Filtra per titolo o ingrediente:</label>
                <input type="text" name="title" placeholder="Es. biscotti di mela, farina..." />
            </div>
            
            <button type="submit" class="search-button">CERCA NEL REGNO</button>
        </form>
    </div>
    
    <div sec:authorize="hasAuthority('ADMIN')" class="admin-link-top">
        <a th:href="@{/admin/manageRecipes}">Vai alla gestione del (Admin)</a>
    </div>

    <div th:if="${#lists.isEmpty(recipes)}">
        <p>Nessuna ricetta  √® stata ancora trovata .</p>
    </div>

    <ul class="recipe-cards-list">
        <li th:each="recipe : ${recipes}" class="recipe-card">
            
            <div class="card-image">
                <img th:src="${recipe.imageUrl} ? ${recipe.imageUrl} : '/images/placeholder-piatto.jpg'" 
                     th:alt="'Immagine di ' + ${recipe.title}"/>
            </div>
            
            <div class="card-content">
                <a th:href="@{/recipe/{id}(id=${recipe.id})}" th:text="${recipe.title}" class="recipe-title">Titolo Ricetta</a>
                
                <div class="card-metadata">
                    <p>üïí Tempo: <span th:text="${recipe.preparationTime}">0</span> min</p>
                    <p>‚≠ê Difficolt√†: <span th:text="${recipe.difficulty}">Facile</span></p>
                    <p>üçΩÔ∏è Porzioni: <span th:text="${recipe.servings}">0</span></p>
                    <p>üè∑Ô∏è Categoria: <span th:text="${recipe.category}">Categoria</span></p>
                </div>
            </div>
            
            <div class="card-actions">
                <a th:href="@{/recipe/{id}(id=${recipe.id})}" class="action-button">SCOPRI LA MAGIA</a>
            </div>
        </li>
    </ul>

    <div sec:authorize="hasAuthority('ADMIN')" class="admin-link-bottom">
        <a th:href="@{/admin/formNewRecipe}">‚ûï Aggiungi una nuova Ricetta</a>
    </div>
</body>

</html>